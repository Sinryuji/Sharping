<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybaits.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="productDAO">

	<select id="selectProductByProductNum" resultType="productVO">
		SELECT * FROM
		PRODUCT WHERE "productNum" = #{productNum}
	</select>

	<select id="selectOptionByProductNum" resultType="optionVO">
		SELECT * FROM
		OPTIONN WHERE "productNum" = #{productNum}
	</select>

	<insert id="insertBasket" parameterType="basketVO">
		INSERT INTO
		BASKET
		values(BASKET_SEQ.nextval, #{id} ,#{optionNum},#{cnt})
	</insert>

	<select id="selectOptionNum" resultType="int">
		SELECT "optionNum" FROM
		OPTIONN WHERE "productNum" = #{productNum} and "optionOneNum" =
		#{optionOneNum} and "optionTwoNum" = #{optionTwoNum} and
		"optionThreeNum" = #{optionThreeNum}
	</select>

	<select id="selectDetailOptionByProductNum"
		resultType="detailOptionVO">
		SELECT * FROM DETAILOPTION WHERE "productNum" =
		#{productNum}
	</select>

	<select id="selectProductById" resultType="productVO">
		SELECT * FROM PRODUCT
		WHERE "id" = #{id}
	</select>

	<select id="selectBasketByOptionNum" parameterType="hashmap" resultType="basketListVO">
		select * from (select b."basketNum", p."productPrice",p."deliveryPrice" , m."id",
		o."productNum",b."cnt" ,o."stock" from OPTIONN o, PRODUCT p, BASKET b, MEMBER m
		where p."productNum" = o."productNum" and b."optionNum" = o."optionNum")
		<foreach collection="array" item="basketNum" open="WHERE" separator="OR">
			"basketNum" = #{basketNum}
		</foreach>
	</select>

	<select id="selectBasketList" resultType="basketListVO">
		SELECT b."basketNum",
		p."productImage", b."optionNum", p."productPrice",p."deliveryPrice"
		,p."productName",
		m."id", o."productNum",o."stock",b."cnt" from OPTIONN
		o, PRODUCT p, BASKET b, MEMBER m
		where p."productNum" = o."productNum"
		and b."optionNum" = o."optionNum"
		and b."id" = #{id}
	</select>

	<update id="updateCnt" parameterType="basketVO">
		UPDATE BASKET set "cnt" = #{cnt} where "id" = #{id} and "optionNum"=#{optionNum}
	</update>
	
	<delete id="deleteBasketByBasketNum" parameterType="basketVO">
		DELETE FROM BASKET where "basketNum" = #{basketNum}
	</delete>




</mapper>